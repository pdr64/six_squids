<!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title> Milestone 1</title>
    <style>
      body{
        padding: 0 80px;
    </style>
</head>
  <body>
    <div id= "header">
      <center><h1>Milestone 1</h1></center>
    </div>
    <div id = "navbar">
      <a href="https://pdr64.github.io/six_squids/"><button class="btn"><i class="fa fa-home"></i> Back to Home Page</button></a>
    </div>
    <br>
    <br>
    <center><h2>Objective </h2></center>
    
    <p>
      The goal of this lab was to get our robot moving autonomously! First we used a basic line sensor on a grid consisting of white tape
      on a black background, finding the values the line sensor reported back and using them to recognize the difference between the lines and 
      the surface. We used this information to have our robot follow a line, ensuring that the middle sensor saw white and the outer two saw black,
      otherwise adjusting accordingly. Once we had this down, we made our robot follow a figure 8 by implementing a state machine, having the robot 
      turn left or right at junctions depending on its state along the path. Gary did a great job; see below!
    </p>
    <br>
    <p>
      In order to implement a straight line, we first attached three line sensors to our robot and began reading the outputs. Based on the value 
      for a white line, we wrote code that told the robot that if it sensed that the center sensor was off the white line and that the right sensor 
      was now on the white line, to veer right back onto the line and visa versa for the other direction.
<code><pre>
int thresh=150;
// correct for veer right
while(analogRead(centSen)>thresh && analogRead(rightSen)>thresh && analogRead(leftSen)<thresh){
  parallax1.write(94);
  parallax2.write(75);     
}
//correct for veer left
while(analogRead(centSen)>thresh && analogRead(rightSen)<thresh && analogRead(leftSen)>thresh){
  parallax1.write(115);
  parallax2.write(94);
}
// go straight
while(analogRead(centSen)<thresh && analogRead(leftSen)>thresh && analogRead(rightSen)>thresh){
  parallax1.write(100);
  parallax2.write(90);
}  
</code></pre>
    </p>
    <br>
    
    <p>
      Now we will discuss how we were able to implememt the 'Figure 8' maneuver. We implemented a finite state machine to do this, where each state is 
      the current leg of the figure 8 that our robot is in. We then simply set up for each leg whether the next turn will be left or right upon reaching an 
      intersection. The relevant code is shown below!
      <code><pre>
      follow_line();
} else {
 if(state==1 || state == 6 || state==7 || state==8){
    Serial.println(String("turning left ")+state );
    Serial.println(analogRead(leftSen)+String("  ")+analogRead(centSen)+String("  ")+analogRead(rightSen));
    turn_left();
    
    if(state==8){
      state=1;
      } else{
        state++;
      }
 } else if (state==2 || state ==3 || state==4 || state==5){
    Serial.println(String("turning right ")+state);
    Serial.println(analogRead(leftSen)+String("  ")+analogRead(centSen)+String("  ")+analogRead(rightSen));
    turn_right();
    state++;
      </pre></code>
      As you can see from the code, we simply need two 'if' statements, wherein we assign a left or right turn following the current state.
      The current state increments after each turn so this process can continue. At the end, state 8 (the last leg of the figure 8) will move to state
      1 and then can restart the process indefinitely. Below is a ~crazy~ video of our robot, Gary, doing some sick figure 8s!
      VIDEO HERE!!!!!!!!!!!!!!!!!!
      <br>
    
    </body>
    </html>
